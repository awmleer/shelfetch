<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>shelfetch</title>

    <!-- 新 Bootstrap 核心 CSS 文件 -->
    <link href="http://apps.bdimg.com/libs/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="http://apps.bdimg.com/libs/jquery/2.0.0/jquery.min.js"></script>
    <!--<script src="js/jquery.min.js"></script>-->
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="http://apps.bdimg.com/libs/bootstrap/3.3.0/js/bootstrap.min.js"></script>


    <script>
        var ssh,jh;
        $(document).ready(function(){
            //读取URL参数
            var url = location.search; //获取url中"?"符后的字串
            if (url.indexOf("?") != -1) {
                var str = url.substr(1);
                var strs = str.split("&");
                ssh=strs[0].split("==")[1];//因为索书号中可能含有等号，所以等号是两个
                $("#lab-ssh").html("索书号：" + ssh);//设置索书号的label
                jh=strs[1].split("=")[1];
                $("#lab-jh").html("第" + jh + "架");//设置架号的label
                $(".shelf"+jh).css("background-color","#bce8f1");
                $(".shelf"+jh).attr("id","anchor");
            }

            //          调整页面布局
            if($(window).height()<$(window).width()){
                $(".container").css("width","500px");
                $(".container").css("margin","0 auto");
            }
        });
    </script>

    <style type="text/css">
        table table td{
            border: solid 1px;
        }
        table table{
            margin: 1em auto;
            width: 70%;
        }
    </style>

</head>
<body>

<div class="container">
    <!--logo-->
    <img src="http://121.42.209.162/shelfetch/pic/logo.png" style="width: 80%;margin: 2em auto;display: block;">

    <div class="alert alert-warning">注：定位的结果有可能会出错（5%左右的概率），目前我们正在努力进行数据的校对，请谅解。</div>

    <button onclick="history.go(-1)" class="btn btn-primary" style="float: right;">返回</button>

    <span class="label label-default" style="display: inline-block;margin: 0.4em 0.5em;">浙江大学紫金港基础图书馆</span>
    <br>
    <span class="label label-default" style="display: inline-block;margin: 0.4em 0.5em;" id="lab-ssh">索书号：XXXX</span>
    <br>
    <span class="label label-default" style="display: inline-block;margin: 0.4em 0.5em;">一层</span>
    <span class="label label-default" style="display: inline-block;margin: 0.4em 0.5em;" id="lab-jh">第*架</span>

    <a href="#anchor"><button class="btn btn-default" style="display: block;margin: 0.5em auto;width: 80%;">点我跳转到书架的位置</button></a>
    <button onclick="submiterror()" class="btn btn-default" style="display: block;margin: 0.5em auto;width: 80%;">位置出错了？快点我提交错误报告</button>
    <button onclick="$('#email').css('display','block')" class="btn btn-default" style="display: block;margin: 0.5em auto;width: 80%;">发送这本书的位置到我的邮箱</button>
    <div id="email" style="display: none;">
        <div class="input-group" style="width: 80%;margin: 0.5em auto;">
            <input id="recv" type="text" class="form-control" placeholder="请输入您的邮箱地址">
               <span class="input-group-btn">
                  <button class="btn btn-default" type="button" onclick="email()">发送</button>
               </span>
        </div>
    </div>

     <!--地图表格-->
    <table style="width: 100%;text-align: center;margin-top: 1em">
        <col width="10%">
        <col width="42%">
        <col width="42%">
        <col width="6%">

        <tr>
            <td rowspan="32" style="border: solid;">
                自<br><br>习<br><br>区<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
                自<br><br>习<br><br>区<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
                自<br><br>习<br><br>区
            </td>
            <td colspan="2">
                <img src="pic/zju/zjgjc/fuwutai.png" width="95%">
            </td>
        </tr>
        <tr>
            <td><table>
                <tr><td rowspan="2" width="33%">柱子</td><td class="shelf2">2</td></tr>
                <tr><td class="shelf3">3</td></tr>
            </table></td>
            <td><table>
                <tr><td rowspan="2" width="50%">柱子</td><td class="shelf1">1</td></tr>
                <tr><td class="shelf4">4</td></tr>
            </table></td>
            <td rowspan="17"></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf6">6</td></tr>
                <tr><td class="shelf7">7</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf5">5</td></tr>
                <tr><td class="shelf8">8</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf10">10</td></tr>
                <tr><td class="shelf11">11</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf9">9</td></tr>
                <tr><td class="shelf12">12</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf14">14</td></tr>
                <tr><td class="shelf15">15</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf13">13</td></tr>
                <tr><td class="shelf16">16</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf18">18</td></tr>
                <tr><td class="shelf19">19</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf17">17</td></tr>
                <tr><td class="shelf20">20</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td rowspan="2" width="30%">柱子</td><td class="shelf22">22</td></tr>
                <tr><td class="shelf23">23</td></tr>
            </table></td>
            <td><table>
                <tr><td rowspan="2" width="30%">柱子</td><td class="shelf21">21</td></tr>
                <tr><td class="shelf24">24</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf26">26</td></tr>
                <tr><td class="shelf27">27</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf25">25</td></tr>
                <tr><td class="shelf28">28</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf30">30</td></tr>
                <tr><td class="shelf31">31</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf29">29</td></tr>
                <tr><td class="shelf32">32</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf34">34</td></tr>
                <tr><td class="shelf35">35</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf33">33</td></tr>
                <tr><td class="shelf36">36</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf38">38</td></tr>
                <tr><td class="shelf39">39</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf37">37</td></tr>
                <tr><td>待上架</td></tr>
            </table></td>
        </tr>

        <tr>
            <td rowspan="2">
                <img src="pic/zju/zjgjc/xzlt.bmp" width="95%">
            </td>
            <td>
                <img src="pic/zju/zjgjc/sf.bmp" width="95%">
            </td>
        </tr>

        <tr>
            <td><table>
                <tr><td rowspan="2" width="30%">柱子</td><td class="shelf">待上架</td></tr>
                <tr><td class="shelf40">40</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf42">42</td></tr>
                <tr><td class="shelf43">43</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf41">41</td></tr>
                <tr><td class="shelf44">44</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf46">46</td></tr>
                <tr><td class="shelf47">47</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf45">45</td></tr>
                <tr><td class="shelf48">48</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf50">50</td></tr>
                <tr><td class="shelf51">51</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf49">49</td></tr>
                <tr><td class="shelf52">52</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf54">54</td></tr>
                <tr><td class="shelf55">55</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf53">53</td></tr>
                <tr><td class="shelf56">56</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td rowspan="2" width="30%">柱子</td><td class="shelf58">58</td></tr>
                <tr><td class="shelf59">59</td></tr>
            </table></td>
            <td><table>
                <tr><td rowspan="2" width="30%">柱子</td><td class="shelf57">57</td></tr>
                <tr><td class="shelf60">60</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf62">62</td></tr>
                <tr><td class="shelf63">63</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf61">61</td></tr>
                <tr><td class="shelf64">64</td></tr>
            </table></td>
            <td rowspan="4">
                <img src="pic/zju/zjgjc/men.png" width="100%">
            </td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf66">66</td></tr>
                <tr><td class="shelf67">67</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf65">65</td></tr>
                <tr><td class="shelf68">68</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf70">70</td></tr>
                <tr><td class="shelf71">71</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf69">69</td></tr>
                <tr><td class="shelf72">72</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf74">74</td></tr>
                <tr><td class="shelf75">75</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf73">73</td></tr>
                <tr><td class="shelf76">76</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td rowspan="2" width="30%">柱子</td><td class="shelf78">78</td></tr>
                <tr><td class="shelf79">79</td></tr>
            </table></td>
            <td><table>
                <tr><td rowspan="2" width="30%">柱子</td><td class="shelf77">77</td></tr>
                <tr><td class="shelf80">80</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf82">82</td></tr>
                <tr><td class="shelf83">83</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf81">81</td></tr>
                <tr><td class="shelf84">84</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf86">86</td></tr>
                <tr><td class="shelf87">87</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf85">85</td></tr>
                <tr><td class="shelf88">88</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf90">90</td></tr>
                <tr><td class="shelf91">91</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf89">89</td></tr>
                <tr><td class="shelf92">92</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf94">94</td></tr>
                <tr><td class="shelf95">95</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf93">93</td></tr>
                <tr><td class="shelf96">96</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td rowspan="2" width="30%">柱子</td><td class="shelf98">98</td></tr>
                <tr><td class="shelf99">99</td></tr>
            </table></td>
            <td><table>
                <tr><td rowspan="2" width="30%">柱子</td><td class="shelf97">97</td></tr>
                <tr><td class="shelf100">100</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf102">102</td></tr>
                <tr><td class="shelf103">103</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf101">101</td></tr>
                <tr><td class="shelf104">104</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf106">106</td></tr>
                <tr><td class="shelf107">107</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf105">105</td></tr>
                <tr><td class="shelf108">108</td></tr>
            </table></td>
        </tr>

        <tr>
            <td><table>
                <tr><td class="shelf110">110</td></tr>
                <tr><td class="shelf111">111</td></tr>
            </table></td>
            <td><table>
                <tr><td class="shelf109">109</td></tr>
                <tr><td class="shelf112">112</td></tr>
            </table></td>
        </tr>

    </table>


    <p class="text-center" style="margin-top: 2em;color: #8c8c8c;">sparker团队&nbsp;&nbsp;
        <!--CNZZ站长统计-->
        <script type="text/javascript">
            var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
            document.write(unescape("%3Cspan id='cnzz_stat_icon_1256977739'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/z_stat.php%3Fid%3D1256977739' type='text/javascript'%3E%3C/script%3E"));
        </script>
    </p>
</div>

<script>
    function submiterror(){
        var url = location.href;
        $.post("http://121.42.209.162/cgi-bin/sferror.py",{url:url,ssh:ssh,jh:jh},
                function(data){
                    if(data=="ok\n"){
                        alert("提交成功，谢谢您的反馈！");
                    }
                }
        );
    };

    function email(){
        var url = location.href;
        url=url.match(/result.*\.html/);
        var recv=$("#recv").val();
        var filter  = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        //检查用户输入的邮箱格式是否正确
        if(filter.test(recv)){
            var obj = {recv: recv, url: url[0], ssh: ssh, jh: jh};
            $.ajax({
                url: "http://121.42.209.162:3031/api/sendmail",
                type: "post",
                data: JSON.stringify(obj)
            }).done(function (data) {
                if (data == "true") {
                    alert("邮件已成功发送");
                }else{
                    alert("发送失败");
                }
            }).fail(function () {
                alert("获取信息失败，请稍后再试");
            });
        }else{
            alert('您的电子邮件格式不正确');
            return false;
        }
    }
</script>

</body>
</html>